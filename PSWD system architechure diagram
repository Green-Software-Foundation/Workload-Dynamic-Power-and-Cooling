graph TB
    %% External Systems
    subgraph EXT ["­Ъїљ External Systems"]
        GRID["РџА Grid Operators<br/>Рђб Load Forecasting<br/>Рђб Demand Response<br/>Рђб Renewable Coordination"]
        MUNICIPAL["­ЪЈў№ИЈ Municipal Utilities<br/>Рђб District Heating<br/>Рђб Waste Heat Recovery<br/>Рђб Heat Quality Control"]
        RENEWABLE["­Ъї▒ Renewable Sources<br/>Рђб Solar/Wind Generation<br/>Рђб Carbon Intensity Data<br/>Рђб Generation Forecasts"]
    end

    %% External Integration Layer
    subgraph EIL ["­ЪћЌ External Integration Layer"]
        GRID_INT["Grid Integration API<br/>Рђб IEC 61850-90-4<br/>Рђб Real-time Capacity<br/>Рђб Frequency Regulation"]
        CARBON_TRACK["Carbon Tracking<br/>Рђб Intensity Monitoring<br/>Рђб Renewable Optimization<br/>Рђб Emissions Reporting"]
        HEAT_COORD["Heat Coordination<br/>Рђб Municipal Integration<br/>Рђб Temperature Control<br/>Рђб Flow Management"]
    end

    %% Infrastructure Control Layer
    subgraph ICL ["­ЪЈЌ№ИЈ Infrastructure Control Layer"]
        POWER_MGT["Power Management<br/>Рђб Load Balancing<br/>Рђб Peak Shaving<br/>Рђб Emergency Response"]
        BATTERY_SYS["Battery Systems<br/>Рђб Energy Storage<br/>Рђб Load Smoothing<br/>Рђб Grid Services"]
        THERMAL_MGT["Thermal Management<br/>Рђб Cooling Control<br/>Рђб Heat Recovery<br/>Рђб Phase Change"]
        PREDICT_ENG["Predictive Engine<br/>Рђб Load Analytics<br/>Рђб Capacity Planning<br/>Рђб Optimization"]
    end

    %% Hardware Abstraction Layer
    subgraph HAL ["­ЪћД Hardware Abstraction Layer"]
        BMC_SYS["Enhanced BMC<br/>Рђб Redfish API Extension<br/>Рђб Sub-second Monitoring<br/>Рђб Sensor Aggregation"]
        POWER_MON["Power Monitoring<br/>Рђб 100ms Resolution<br/>Рђб ┬▒0.5% Accuracy<br/>Рђб Quality Metrics"]
        THERMAL_SEN["Thermal Sensors<br/>Рђб Temperature: ┬▒0.1┬░C<br/>Рђб Flow: ┬▒1% Accuracy<br/>Рђб Pressure Control"]
        COOLING_HW["Cooling Hardware<br/>Рђб Single/Two-Phase<br/>Рђб Liquid Circulation<br/>Рђб Heat Exchangers"]
    end

    %% Workload Interface Layer
    subgraph WIL ["­Ъњ╗ Workload Interface Layer"]
        WL_API["Workload API<br/>Рђб Event-driven Messaging<br/>Рђб Sub-second Response<br/>Рђб JSON Web Tokens"]
        SCHED_INT["Scheduler Integration<br/>Рђб Kubernetes<br/>Рђб Resource Managers<br/>Рђб Container Orchestration"]
        FLEX_MGT["Flexibility Management<br/>Рђб Throttling Control<br/>Рђб Migration Support<br/>Рђб Priority Handling"]
    end

    %% Computational Workloads
    subgraph WORKLOADS ["­ЪДа Computational Workloads"]
        AI_TRAIN["AI Training<br/>Рђб 200+ MW Swings<br/>Рђб 40ms Transitions<br/>Рђб High Priority"]
        AI_INFER["AI Inference<br/>Рђб Real-time Serving<br/>Рђб Variable Load<br/>Рђб Low Latency"]
        HPC["HPC Applications<br/>Рђб Scientific Computing<br/>Рђб Batch Processing<br/>Рђб Predictable Load"]
        TRAD_COMP["Traditional Compute<br/>Рђб Web Services<br/>Рђб Databases<br/>Рђб Steady State"]
    end

    %% Physical Infrastructure
    subgraph PHYS ["РџЎ№ИЈ Physical Infrastructure"]
        POWER_DIST["Power Distribution<br/>Рђб Transformers<br/>Рђб Circuit Breakers<br/>Рђб UPS Systems"]
        BATTERY_PHYS["Battery Storage<br/>Рђб Li-ion Arrays<br/>Рђб Inverters<br/>Рђб Safety Systems"]
        COOLING_PHYS["Cooling Systems<br/>Рђб Liquid Loops<br/>Рђб Heat Exchangers<br/>Рђб Pumps & Valves"]
        BUILDING["Building Systems<br/>Рђб HVAC Integration<br/>Рђб Fire Safety<br/>Рђб Environmental Control"]
    end

    %% Security Layer (Cross-cutting)
    subgraph SEC ["­Ъћњ Security Framework"]
        AUTH["Authentication<br/>Рђб X.509 Certificates<br/>Рђб JWT Tokens<br/>Рђб Role-based Access"]
        CRYPTO["Message Security<br/>Рђб TLS 1.3<br/>Рђб HMAC-SHA256<br/>Рђб Digital Signatures"]
        NETWORK["Network Security<br/>Рђб VLAN Isolation<br/>Рђб Intrusion Detection<br/>Рђб Emergency Disconnect"]
    end

    %% Data Flows and Control Signals
    GRID -.->|Grid Status & Signals| GRID_INT
    RENEWABLE -.->|Generation Data| CARBON_TRACK
    MUNICIPAL -.->|Heat Demand| HEAT_COORD
    
    GRID_INT -->|Demand Response| POWER_MGT
    CARBON_TRACK -->|Optimization Signals| PREDICT_ENG
    HEAT_COORD -->|Heat Recovery Control| THERMAL_MGT
    
    POWER_MGT -->|Battery Commands| BATTERY_SYS
    POWER_MGT -->|Load Control| POWER_MON
    THERMAL_MGT -->|Cooling Commands| THERMAL_SEN
    PREDICT_ENG -->|Forecasts| POWER_MGT
    PREDICT_ENG -->|Thermal Prep| THERMAL_MGT
    
    BMC_SYS -->|Hardware Status| POWER_MGT
    POWER_MON -->|Real-time Data| PREDICT_ENG
    THERMAL_SEN -->|Temperature Data| THERMAL_MGT
    COOLING_HW -->|System Status| THERMAL_SEN
    
    WL_API -->|Workload Announcements| POWER_MGT
    WL_API -->|Resource Requests| THERMAL_MGT
    SCHED_INT -->|Job Scheduling| WL_API
    FLEX_MGT -->|Control Commands| WL_API
    
    AI_TRAIN -->|Power Profile| WL_API
    AI_INFER -->|Resource Needs| WL_API
    HPC -->|Batch Requests| WL_API
    TRAD_COMP -->|Steady Load| WL_API
    
    POWER_MGT -.->|Infrastructure Response| WL_API
    THERMAL_MGT -.->|Thermal Status| WL_API
    BATTERY_SYS -.->|Storage Status| WL_API
    
    POWER_MON -->|Measurements| POWER_DIST
    BATTERY_SYS -->|Charge/Discharge| BATTERY_PHYS
    THERMAL_SEN -->|Control Signals| COOLING_PHYS
    THERMAL_MGT -->|Building Integration| BUILDING
    
    %% Security Integration (shown as protective layer)
    AUTH -.->|Secure Access| WL_API
    CRYPTO -.->|Message Integrity| GRID_INT
    NETWORK -.->|Traffic Isolation| BMC_SYS
    
    %% Critical Performance Requirements
    classDef criticalPath fill:#ff9999,stroke:#ff0000,stroke-width:2px
    classDef realTime fill:#99ff99,stroke:#00ff00,stroke-width:2px
    classDef external fill:#9999ff,stroke:#0000ff,stroke-width:2px
    classDef security fill:#ffff99,stroke:#ffaa00,stroke-width:2px
    
    class AI_TRAIN,POWER_MON,BATTERY_SYS criticalPath
    class WL_API,BMC_SYS,THERMAL_SEN realTime
    class GRID,MUNICIPAL,RENEWABLE external
    class AUTH,CRYPTO,NETWORK security