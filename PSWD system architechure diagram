```mermaid
graph TD
    %% External Systems
    GRID[Grid Operators<br/>Load Forecasting<br/>Demand Response]
    MUNICIPAL[Municipal Utilities<br/>District Heating<br/>Waste Heat Recovery]
    RENEWABLE[Renewable Sources<br/>Solar/Wind<br/>Carbon Intensity]

    %% External Integration Layer
    subgraph EIL[External Integration Layer]
        GRID_API[Grid Integration API<br/>IEC 61850-90-4]
        CARBON_TRACK[Carbon Tracking<br/>Renewable Optimization]
        HEAT_COORD[Heat Coordination<br/>Municipal Integration]
    end

    %% Infrastructure Control Layer  
    subgraph ICL[Infrastructure Control Layer]
        POWER_MGT[Power Management<br/>Load Balancing<br/>Peak Shaving]
        BATTERY_SYS[Battery Systems<br/>Energy Storage<br/>Load Smoothing]
        THERMAL_MGT[Thermal Management<br/>Cooling Control<br/>Heat Recovery]
        PREDICT_ENG[Predictive Engine<br/>Load Analytics<br/>Optimization]
    end

    %% Hardware Abstraction Layer
    subgraph HAL[Hardware Abstraction Layer]
        BMC[Enhanced BMC<br/>Redfish API<br/>Sub-second Monitoring]
        POWER_MON[Power Monitoring<br/>100ms Resolution<br/>±0.5% Accuracy]
        THERMAL_SEN[Thermal Sensors<br/>±0.1°C Temperature<br/>±1% Flow Accuracy]
    end

    %% Workload Interface Layer
    subgraph WIL[Workload Interface Layer]
        WORKLOAD_API[Workload API<br/>Event-driven Messaging<br/>Sub-500ms Response]
        SCHEDULER[Scheduler Integration<br/>Kubernetes<br/>Resource Managers]
        FLEXIBILITY[Flexibility Management<br/>Throttling<br/>Migration]
    end

    %% Computational Workloads
    AI_TRAINING[AI Training<br/>200+ MW Swings<br/>40ms Transitions]
    AI_INFERENCE[AI Inference<br/>Real-time Serving<br/>Variable Load]
    HPC[HPC Applications<br/>Scientific Computing<br/>Batch Processing]
    TRADITIONAL[Traditional Compute<br/>Web Services<br/>Steady State]

    %% Physical Infrastructure
    POWER_DIST[Power Distribution<br/>Transformers<br/>UPS Systems]
    BATTERY_PHYS[Battery Storage<br/>Li-ion Arrays<br/>Inverters]
    COOLING_PHYS[Cooling Systems<br/>Liquid Loops<br/>Heat Exchangers]

    %% Security Layer
    subgraph SEC[Security Framework]
        AUTH[Authentication<br/>X.509 Certificates<br/>JWT Tokens]
        CRYPTO[Message Security<br/>TLS 1.3<br/>HMAC-SHA256]
        NETWORK[Network Security<br/>VLAN Isolation<br/>Intrusion Detection]
    end

    %% External Connections
    GRID --> GRID_API
    MUNICIPAL --> HEAT_COORD
    RENEWABLE --> CARBON_TRACK

    %% External Integration to Infrastructure Control
    GRID_API --> POWER_MGT
    CARBON_TRACK --> PREDICT_ENG
    HEAT_COORD --> THERMAL_MGT

    %% Infrastructure Control Layer Connections
    POWER_MGT --> BATTERY_SYS
    PREDICT_ENG --> POWER_MGT
    PREDICT_ENG --> THERMAL_MGT
    POWER_MGT <--> THERMAL_MGT

    %% Hardware Abstraction Connections
    BMC --> POWER_MGT
    POWER_MON --> PREDICT_ENG
    THERMAL_SEN --> THERMAL_MGT
    POWER_MGT --> POWER_MON
    THERMAL_MGT --> THERMAL_SEN

    %% Workload Interface Connections
    WORKLOAD_API --> POWER_MGT
    WORKLOAD_API --> THERMAL_MGT
    SCHEDULER --> WORKLOAD_API
    FLEXIBILITY --> WORKLOAD_API

    %% Workload to Interface Connections
    AI_TRAINING --> WORKLOAD_API
    AI_INFERENCE --> WORKLOAD_API
    HPC --> WORKLOAD_API
    TRADITIONAL --> WORKLOAD_API

    %% Hardware Connections
    POWER_MON --> POWER_DIST
    BATTERY_SYS --> BATTERY_PHYS
    THERMAL_SEN --> COOLING_PHYS

    %% Infrastructure Response (feedback)
    POWER_MGT -.-> WORKLOAD_API
    THERMAL_MGT -.-> WORKLOAD_API
    BATTERY_SYS -.-> WORKLOAD_API

    %% Grid Response (feedback)
    POWER_MGT -.-> GRID_API
    GRID_API -.-> GRID

    %% Municipal Heat Response (feedback)
    THERMAL_MGT -.-> HEAT_COORD
    HEAT_COORD -.-> MUNICIPAL

    %% Security Integration
    AUTH --> WORKLOAD_API
    CRYPTO --> GRID_API
    NETWORK --> BMC

    %% Critical Path Styling
    style AI_TRAINING fill:#ffcccc
    style POWER_MON fill:#ffcccc
    style BATTERY_SYS fill:#ffcccc
    style WORKLOAD_API fill:#ccffcc
    style BMC fill:#ccffcc
    style THERMAL_SEN fill:#ccffcc
    style GRID fill:#ccccff
    style MUNICIPAL fill:#ccccff
    style RENEWABLE fill:#ccccff
    style AUTH fill:#ffffcc
    style CRYPTO fill:#ffffcc
    style NETWORK fill:#ffffcc
```
